function [A,B,C,D]=nspline(X,Y)
clc;
for i=1:1:length(X)-1
    
    h(i)=X(i+1)-X(i)
    
end

% M=[1,0,0,0,0; h(1),2*(h(1)+h(2)),h(2),0,0; 0,h(2),2*(h(2)+h(3)),h(3),0;0,0, h(3), 2*(h(3)+h(4)), h(4);0,0,0,0,1]
% N=[0;3*((y(3)-y(2))/h(2)-(y(2)-y(1))/h(1));3*((y(4)-y(3))/h(3)-(y(3)-y(2))/h(2));3*((y(5)-y(4))/h(4)-(y(4)-y(3))/h(3));0]

M=[1,0,0,0; h(1),2*(h(1)+h(2)),h(2),0; 0,h(2),2*(h(2)+h(3)),h(3);0,0,0,1]
N=[0;3*((Y(3)-Y(2))/h(2)-(Y(2)-Y(1))/h(1));3*((Y(4)-Y(3))/h(3)-(Y(3)-Y(2))/h(2));0]

C=inv(M)*N

for i=1:1:length(X)-1
    A(i)=Y(i)
    B(i)=(Y(i+1)-Y(i))/h(i)-((2*C(i)+C(i+1))*h(i))/3
    D(i)=(C(i+1)-C(i))/(3*h(i))
    
    
    xint=X(i):(X(i+1)-X(i))/100:X(i+1);
    
    G(i,:)=A(i)+(B(i)*(xint-X(i)))+(C(i)*(xint-X(i)).^2)+(D(i)*(xint-X(i)).^3)
    
    plot(xint,G(i,:))
    hold on
    
end

end